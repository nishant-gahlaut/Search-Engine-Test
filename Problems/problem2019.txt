b'\nRead problem statements in Hindi, Bengali, Mandarin Chinese, Russian and Vietnamese as well.\nChef loves graphs. To express his love, he defines a function f(G,x,y)f(G,x,y) for an undirected connected graph GG with weighted edges and two of its vertices xx, yy. f(G,x,y)f(G,x,y) is defined as the minimum of weights of all paths in GG between the vertices xx and yy, where the weight of a path is the maximum of weights of edges in this path.\nChef has two connected graphs G1G1 and G2G2. Each of these graphs has NN vertices (labelled 11 through NN) and MM edges. Calculate S=\xe2\x88\x91i=1N\xe2\x88\x921\xe2\x88\x91j=i+1Nf(G1,i,j)\xe2\x8b\x85f(G2,i,j)S=\xe2\x88\x91i=1N\xe2\x88\x921\xe2\x88\x91j=i+1Nf(G1,i,j)\xe2\x8b\x85f(G2,i,j) modulo 998,244,353998,244,353.\nInput\n\nThe first line of the input contains two space-separated integers NN and MM.\nMM lines follow. Each of these lines contains three space-separated integers uu, vv and ww denoting that vertices uu and vv in G1G1 are connected by an edge with weight ww.\nMM more lines follow. Each of these lines contains three space-separated integers uu, vv and ww denoting that vertices uu and vv in G2G2 are connected by an edge with weight ww.\n\nOutput\nPrint a single line containing one integer \xe2\x80\x94 the sum SS modulo 998,244,353998,244,353.\nConstraints\n\n1\xe2\x89\xa4N\xe2\x89\xa41051\xe2\x89\xa4N\xe2\x89\xa4105\nM=2NM=2N\n1\xe2\x89\xa4u,v\xe2\x89\xa4N1\xe2\x89\xa4u,v\xe2\x89\xa4N\n1\xe2\x89\xa4w\xe2\x89\xa41081\xe2\x89\xa4w\xe2\x89\xa4108\nG1G1 and G2G2 are connected graphs\n\nSubtasks\nSubtask #1 (20 points): N=2,000N=2,000\nSubtask #2 (30 points):\n\nN=105N=105\nG1G1 and G2G2 are identical graphs\n\nSubtask #3 (50 points): original constraints\n\n                        Sample Input 1\n                        \n\n\n\n\n\n3 6\n1 2 3\n2 3 1\n3 1 2\n1 2 4\n2 3 5\n3 1 6\n1 2 2\n2 3 1\n3 1 3\n1 2 5\n2 3 4\n3 1 6\n\n\n\n                        Sample Output 1\n                        \n\n\n\n\n\n9\n\n\n\n\n\nAuthor:\n6\xe2\x98\x85nqiiii\n\n\nEditorial:\nhttps://discuss.codechef.com/problems/MXMN\n\n\nTags:\n\n               \n                 Centroid Decomposition, Auxiliary Tree\n                 \n                     \n                     Advanced Algorithms, Advanced Graph Algos\n                 \n               \n             \n             \n\n\n\n                        Difficulty Rating:\n                    \n\n2754\n\n\nDate Added:\n14-06-2019\n\n\nTime Limit:\n4 secs\n\n\nSource Limit:\n50000 Bytes\n\n\nLanguages:\nPYTH 3.6, JAVA, C, CPP14, PYTH, PYP3, CS2, ADA, PYPY, TEXT, PAS fpc, NODEJS, RUBY, PHP, GO, HASK, TCL, kotlin, PERL, SCALA, LUA, BASH, JS, rust, LISP sbcl, PAS gpc, BF, CLOJ, R, D, CAML, swift, FORT, ASM, FS, WSPC, LISP clisp, SQL, SCM guile, PERL6, ERL, CLPS, PRLG, ICK, NICE, ICON, COB, SCM chicken, PIKE, SCM qobi, ST, NEM\n\n\n\n\n\nSubmit\n\n'