b"\nRead problem statements in Hindi, Bengali, Mandarin Chinese, Russian, and Vietnamese as well.\nYou are given a tree with NN vertices numbered 11 through NN. For each valid ii, initially, vertex ii has value WiWi. The value of each vertex can be either \xe2\x88\x921\xe2\x88\x921 or a non-negative integer.\nAt any time, let's denote the sequence of values of vertices on the path from vertex uu to vertex vv by S(u,v)S(u,v). We are interested in replacing each element \xe2\x88\x921\xe2\x88\x921 in such a sequence by a non-negative integer (not necessarily the same for each \xe2\x88\x921\xe2\x88\x921).\nYou should process QQ queries of five types:\n\nUPDATE U X: Change the value of vertex UU to XX.\nINCREASING U V A B: Find the number of ways to replace each \xe2\x88\x921\xe2\x88\x921 in the sequence S(U,V)S(U,V) by an integer such that the resulting sequence is strictly increasing and contains only integers between AA and BB (inclusive).\nDECREASING U V A B: Find the number of ways to replace each \xe2\x88\x921\xe2\x88\x921 in the sequence S(U,V)S(U,V)by an integer such that the resulting sequence is strictly decreasing and contains only integers between AA and BB (inclusive).\nNON-DECREASING U V A B: Find the number of ways to replace each \xe2\x88\x921\xe2\x88\x921 in the sequence S(U,V)S(U,V) by an integer such that the resulting sequence is non-decreasing and contains only integers between AA and BB (inclusive).\nNON-INCREASING U V A B: Find the number of ways to replace each \xe2\x88\x921\xe2\x88\x921 in the sequence S(U,V)S(U,V) by an integer such that the resulting sequence is non-increasing and contains only integers between AA and BB (inclusive).\n\nInput\n\nThe first line of the input contains two space-separated integers NN and QQ.\nThe second line contains NN space-separated integers W1,W2,\xe2\x80\xa6,WNW1,W2,\xe2\x80\xa6,WN.\nEach of the next N\xe2\x88\x921N\xe2\x88\x921 lines contains two space-separated integers UU and VV denoting that vertices UU and VV are connected by an edge.\nQQ lines follow. Each of these lines describes one query in the format given above.\n\nOutput\nFor each query except the UPDATE queries, print a single line containing one integer \xe2\x80\x95 the number of ways to replace each \xe2\x88\x921\xe2\x88\x921, modulo 109+7109+7.\nConstraints\n\n1\xe2\x89\xa4N,Q\xe2\x89\xa41051\xe2\x89\xa4N,Q\xe2\x89\xa4105\n1\xe2\x89\xa4U,V\xe2\x89\xa4N1\xe2\x89\xa4U,V\xe2\x89\xa4N\n\xe2\x88\x921\xe2\x89\xa4Wi\xe2\x89\xa4106\xe2\x88\x921\xe2\x89\xa4Wi\xe2\x89\xa4106 for each valid ii\n0\xe2\x89\xa4A\xe2\x89\xa4B\xe2\x89\xa41060\xe2\x89\xa4A\xe2\x89\xa4B\xe2\x89\xa4106\n\xe2\x88\x921\xe2\x89\xa4X\xe2\x89\xa4106\xe2\x88\x921\xe2\x89\xa4X\xe2\x89\xa4106\n\nSubtasks\nSubtask #1 (10 points): 1\xe2\x89\xa4N,Q\xe2\x89\xa41,0001\xe2\x89\xa4N,Q\xe2\x89\xa41,000\nSubtask #2 (10 points):\n\nWi=\xe2\x88\x921Wi=\xe2\x88\x921 for each valid ii\nX=\xe2\x88\x921X=\xe2\x88\x921\n\nSubtask #3 (80 points): original constraints\n\n                        Sample Input 1\n                        \n\n\n\n\n\n8 3\n1 2 3 -1 -1 -1 -1 -1\n1 2\n2 3\n2 5\n2 6\n4 5\n5 7\n5 8\nINCREASING 1 5 1 10\nUPDATE 1 -1\nNON-DECREASING 1 5 0 10\n\n\n\n                        Sample Output 1\n                        \n\n\n\n\n\n8\n27\n\n\n\n\n\nAuthor:\n7\xe2\x98\x85daniel_1999\n\n\nEditorial:\nhttps://discuss.codechef.com/problems/TSEQ\n\n\nTags:\n\n               \n                 aug19, combinatorics, daniel_1999, hard, heavy-light-decomposition, segment-tree, vijju123\n                 \n               \n             \n             \n\n\n\n                        Difficulty Rating:\n                    \n\n2860\n\n\nDate Added:\n1-05-2019\n\n\nTime Limit:\n3 secs\n\n\nSource Limit:\n50000 Bytes\n\n\nLanguages:\nPYTH 3.6, JAVA, C, CPP14, PYTH, PYP3, CS2, ADA, PYPY, TEXT, PAS fpc, NODEJS, RUBY, PHP, GO, HASK, TCL, kotlin, PERL, SCALA, LUA, BASH, JS, rust, LISP sbcl, PAS gpc, BF, CLOJ, R, D, CAML, swift, FORT, ASM, FS, WSPC, LISP clisp, SQL, SCM guile, PERL6, ERL, CLPS, PRLG, ICK, NICE, ICON, COB, SCM chicken, PIKE, SCM qobi, ST, NEM\n\n\n\n\n\nSubmit\n\n"