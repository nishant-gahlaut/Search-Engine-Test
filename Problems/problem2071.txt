b"\nRead problems statements in Mandarin chinese and Vietnamese as well.\nYou are given a tree with NN nodes (numbered 11 through NN) and N\xe2\x88\x921N\xe2\x88\x921 edges. Each node has a value; let's denote the value of node xx by WxWx.\nNext, let's define the value of a simple path v1,v2,\xe2\x80\xa6,vkv1,v2,\xe2\x80\xa6,vk as \xe2\x88\x91ki=1i\xe2\x8b\x85Wvi\xe2\x88\x91i=1ki\xe2\x8b\x85Wvi. A simple path in a tree is a sequence of nodes v1,v2,\xe2\x80\xa6,vkv1,v2,\xe2\x80\xa6,vk such that:\n\nk\xe2\x89\xa51k\xe2\x89\xa51\nthere is an edge between nodes vivi and vi+1vi+1 for each ii (1\xe2\x89\xa4i\xe2\x89\xa4k\xe2\x88\x9211\xe2\x89\xa4i\xe2\x89\xa4k\xe2\x88\x921)\nvi\xe2\x89\xa0vjvi\xe2\x89\xa0vj for each i,ji,j (1\xe2\x89\xa4i,j\xe2\x89\xa4k1\xe2\x89\xa4i,j\xe2\x89\xa4k) such that i\xe2\x89\xa0ji\xe2\x89\xa0j\n\nYou should find the maximum of values of all simple paths in the given tree.\nInput\n\nThe first line of the input contains a single integer TT denoting the number of test cases. The description of TT test cases follows.\nThe first line of each test case contains a single integer NN.\nThe second line contains NN space-separated integers W1,W2,\xe2\x80\xa6,WNW1,W2,\xe2\x80\xa6,WN.\nEach of the following N\xe2\x88\x921N\xe2\x88\x921 lines contains two space-separated integers uu and vv denoting an edge between nodes uu and vv.\n\nOutput\nFor each test case, print a single line containing one integer \xe2\x80\x94 the maximum value of a simple path.\nConstraints\n\n2\xe2\x89\xa4N\xe2\x89\xa450,0002\xe2\x89\xa4N\xe2\x89\xa450,000\nthe sum of NN over all test cases does not exceed 400,000400,000\n1\xe2\x89\xa4u,v\xe2\x89\xa4N1\xe2\x89\xa4u,v\xe2\x89\xa4N\nu\xe2\x89\xa0vu\xe2\x89\xa0v\n|Wi|\xe2\x89\xa41,000|Wi|\xe2\x89\xa41,000 for each valid ii\nthe graph described in the input is a tree\n\nSubtasks\nSubtask #1 (30 points): the tree is a binary tree rooted at node 1\nSubtask #2 (30 points):\n\nthe length (number of nodes) of any simple path in the tree is at most 200200\nthe sum of NN over all test cases does not exceed 100,000100,000\n\nSubtask #3 (40 points): original constraints\n\n                        Sample Input 1\n                        \n\n\n\n\n\n3\n5\n1 2 3 4 5\n1 2\n2 3\n3 4\n3 5\n2\n-1 -1\n1 2\n3\n1 1000 -30\n1 3\n2 3\n\n\n\n                        Sample Output 1\n                        \n\n\n\n\n\n34\n-1\n2941\n\n\n\n\n\nAuthor:\nratingoverflow\n\n\nEditorial:\nhttps://discuss.codechef.com/problems/TSUM2\n\n\nTags:\n\n               \n                 Trees, Centroid Decomposition, Lines, Convex Hull\n                 \n                     \n                     Data Structures, Graphs, Advanced Algorithms, Advanced Graph Algos, Computational Geometry, Polygons\n                 \n               \n             \n             \n\n\n\n                        Difficulty Rating:\n                    \n\n2814\n\n\nDate Added:\n12-05-2018\n\n\nTime Limit:\n3 secs\n\n\nSource Limit:\n50000 Bytes\n\n\nLanguages:\nPYTH 3.6, JAVA, C, CPP14, PYTH, PYP3, CS2, ADA, PYPY, TEXT, PAS fpc, NODEJS, RUBY, PHP, GO, HASK, TCL, kotlin, PERL, SCALA, LUA, BASH, JS, rust, LISP sbcl, PAS gpc, BF, CLOJ, D, CAML, swift, FORT, ASM, FS, WSPC, LISP clisp, SCM guile, PERL6, ERL, CLPS, PRLG, ICK, NICE, ICON, COB, SCM chicken, PIKE, SCM qobi, ST, NEM\n\n\n\n\n\nSubmit\n\n"