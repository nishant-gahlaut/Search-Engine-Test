b"\n\nYou are given a simple connected graph G with N vertices and N edges (a simple graph is an un-directed graph that has no loops and no more than one edge between any two different vertices).\nIt is obvious that the graph G contains exactly one cycle and you can assume that the length of this cycle is odd (there are odd number of vertices in this cycle).\nThe vertices are numbered from 1 to N. Each edge is assigned a corresponding integer weight. \nYour mission is to stimulate two types of queries :\n\n\nUpdate query represented by f u v: change the sign of all the weights of the edges on the shortest path (you can see the definition of shortest path in this problem later on) from vertex u to vertex v.\n\n\nFind query represented by ? u v: On the shortest path from vertex u to vertex v, find the (possibly empty) set of consecutive edges such that the sum of the weights is maximal. In other words, let's define the shortest path from u to v as a_1, a_2, ..., a_k (where a_1 = u and a_k = v). You have to find a_i and a_j such that i <= j and the sum of the weights of the edges of the path a_i, a_(i + 1), ..., a_j is as large as possible. You just have to find that sum.\n\n\n\n\nThe shortest path between two vertices u and v is the path connecting them with the minimal number of vertices. In this problem, it is obvious that there is only one shortest path between any pair of vertices of G.\n\nInput\nThe first line contains an integer N. Each of the next N lines represents an edge of the graph with three integers u v c which mean there is an edge connecting vertices u and v and it is has weight c.\nThe next line contains an integer Q, the number of queries. Each of the next Q lines represents a query in one of the two forms above.\n\nOutput\n\nFor each find query, print the result of the query (the maximal sum) on a line.\n\nConstraints\n\n1 \xe2\x89\xa4 N \xe2\x89\xa4 100,000\n1 \xe2\x89\xa4 u, v \xe2\x89\xa4 N\n-10,000 \xe2\x89\xa4 c \xe2\x89\xa4 10,000\n1 \xe2\x89\xa4 Q \xe2\x89\xa4 100,000\n\nExample\nInput:\n6\n1 2 1\n2 3 1\n3 1 1\n2 4 1\n4 5 1\n3 6 1\n3\n? 5 6\nf 2 3\n? 5 6\n\nOutput:\n4\n2\n\nExplanation\nThe shortest path from 5 to 6 is 5, 4, 2, 3, 6. All the edges on this path have weight 1 so the answer to the first query is 4. After the second query, the weight of the edge (2, 3) is - 1. The edges on the path 5, 4, 2, 3, 6 have weights 1, 1, -1, 1 respectively. so the answer for the third query is 2.\n\n\n\nAuthor:\ntuan_adm\n\n\nTester:\n6\xe2\x98\x85pieguy\n\n\nEditorial:\nhttps://discuss.codechef.com/problems/QTREE\n\n\nTags:\n\n               \n                 Lazy Propagation, HLD\n                 \n                     \n                     Advanced Data Structures, Advanced Tree Structures, Segment Trees, Advanced Algorithms, Advanced Graph Algos\n                 \n               \n             \n             \n\n\n\n                        Difficulty Rating:\n                    \n\n2664\n\n\nDate Added:\n26-12-2012\n\n\nTime Limit:\n2 secs\n\n\nSource Limit:\n50000 Bytes\n\n\nLanguages:\nPYTH 3.6, JAVA, C, CPP14, PYTH, PYP3, CS2, ADA, TEXT, PAS fpc, NODEJS, RUBY, PHP, GO, HASK, TCL, PERL, SCALA, LUA, BASH, JS, LISP sbcl, PAS gpc, BF, CLOJ, D, CAML, FORT, ASM, FS, WSPC, LISP clisp, SCM guile, PERL6, ERL, CLPS, PRLG, ICK, NICE, ICON, PIKE, SCM qobi, ST, NEM\n\n\n\n\n\nSubmit\n\n"