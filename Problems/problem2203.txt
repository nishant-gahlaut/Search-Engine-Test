b"\nRead problem statements in Russian, Mandarin and Vietnamese as well.\nLet's denote the length of the Longest Increasing Subsequence of the array BB by LIS(B)LIS(B). \nFor a permutation AA of integers from 11 to NN we can define two arrays of integers PP and SS, both of length NN: Pi=LIS(A[1:i])=LIS([A1,A2,\xe2\x80\xa6,Ai])Pi=LIS(A[1:i])=LIS([A1,A2,\xe2\x80\xa6,Ai]), Si=LIS(A[i:N])=LIS([Ai,Ai+1,\xe2\x80\xa6,AN])Si=LIS(A[i:N])=LIS([Ai,Ai+1,\xe2\x80\xa6,AN]).\nLet's call a pair of arrays (P,S)(P,S) viableviable, if there exists a permutation AA with these arrays as PP and SS.\nGiven array PP of length NN, calculate the number of arrays SS such that (P,S)(P,S) is viable, modulo 998244353998244353.\nInput Format\n\nThe first line of input contains one integer NN \xe2\x88\x92\xe2\x88\x92 the length of the array PP.\nThe second line of input contains NN integers P1,P2,\xe2\x80\xa6,PNP1,P2,\xe2\x80\xa6,PN.\n\nOutput Format\nPrint a single integer \xe2\x88\x92\xe2\x88\x92 the answer to the problem modulo 998244353998244353.\nConstraints\n\n1\xe2\x89\xa4N\xe2\x89\xa45000001\xe2\x89\xa4N\xe2\x89\xa4500000\n1\xe2\x89\xa4Pi\xe2\x89\xa4N1\xe2\x89\xa4Pi\xe2\x89\xa4N.\n\n\n                        Sample Input 1\n                        \n\n\n\n\n\n3\n1 2 3\n\n\n\n                        Sample Output 1\n                        \n\n\n\n\n\n1\n\n\nExplanation\nIt can be shown that the only array SS, for which pair (P,S)(P,S) is viable, is [3,2,1][3,2,1].\n\n                        Sample Input 2\n                        \n\n\n\n\n\n3\n3 3 3\n\n\n\n                        Sample Output 2\n                        \n\n\n\n\n\n0\n\n\nExplanation\nIt can be shown that there is no permutation with such array PP.\n\n                        Sample Input 3\n                        \n\n\n\n\n\n6\n1 1 1 2 2 2\n\n\n\n                        Sample Output 3\n                        \n\n\n\n\n\n2\n\n\n\n                        Sample Input 4\n                        \n\n\n\n\n\n8\n1 2 3 3 4 4 4 4\n\n\n\n                        Sample Output 4\n                        \n\n\n\n\n\n7\n\n\n\n                        Sample Input 5\n                        \n\n\n\n\n\n17\n1 1 1 2 2 3 3 3 3 4 4 5 5 6 6 6 7\n\n\n\n                        Sample Output 5\n                        \n\n\n\n\n\n28\n\n\n\n\n\nAuthor:\n7\xe2\x98\x85um_nik\n\n\nEditorial:\nhttps://discuss.codechef.com/problems/PSLISCNT\n\n\nTags:\n\n               \n                 hard, sdelp21, snckel21, um_nik\n                 \n               \n             \n             \n\n\n\n                        Difficulty Rating:\n                    \n\n9999\n\n\nDate Added:\n3-12-2021\n\n\nTime Limit:\n10 secs\n\n\nSource Limit:\n50000 Bytes\n\n\nLanguages:\nCPP17, PYTH 3.6, JAVA, C, CPP14, PYTH, PYP3, CS2, ADA, PYPY, TEXT, PAS fpc, NODEJS, RUBY, PHP, GO, HASK, TCL, kotlin, PERL, SCALA, LUA, BASH, JS, rust, LISP sbcl, PAS gpc, BF, CLOJ, R, D, CAML, swift, FORT, ASM, FS, WSPC, LISP clisp, SQL, SCM guile, PERL6, ERL, CLPS, PRLG, SQLQ, ICK, NICE, ICON, COB, SCM chicken, PIKE, SCM qobi, ST, NEM\n\n\n\n\n\nSubmit\n\n"