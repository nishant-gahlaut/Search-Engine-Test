b"\nRead problems statements in mandarin chinese, russian and vietnamese as well.\n\n  After playing board games, buying letters, and shuffling decks, Mathison has finally decided to study. He opens his favorite book,\n  CLRS, and decides to solve a graph problem. The problem is described below and you can find it by its number, 25.1-11, on page 693 (3rd edition only).\n\n\n  You are given a tree\n  with N nodes where each node has a value associated with it.\n\n\n  Define PROD(u, v) to be the product of all values on the path from node u to node v.\n\n\n  The problem is to find the longest path (u, v) such that PROD(u, v) is a\n  cubic number\n  (i.e. there is some natural number k such that k3 = PROD(u, v)).\n\n\n  Mathison has no idea how to solve this problem so he asks you for help! \n  Given T instances of this task, can you find the answer for each one of them so Mathison can proceed to the next chapter?\n\nInput\n\n  The first line contains the number of tests, T.\n\n\n  The description of a test starts with one line that contains the number of nodes, N.\n\n\n  The second line contains N space-separated integers, representing the values of the nodes.\n\n\n  Each of the following N-1 lines contain a single pair of integers u, v, representing an edge from u to v.\n\nOutput\n\n  The output file must contain T lines, each one containing the answer (i.e. the longest path that generates a cubic number) for the corresponding test. If there's no such path then output -1 instead.\n\nConstraints\n\n1 \xe2\x89\xa4 T \xe2\x89\xa4 5000\n1 \xe2\x89\xa4 N \xe2\x89\xa4 100,000 (i.e. 105)\n1 \xe2\x89\xa4 valuex \xe2\x89\xa4 1,000,000 (i.e. 106)\n\nSubtaks\nSubtask #1 (10 points):\n\n1 \xe2\x89\xa4 T \xe2\x89\xa4 5000\n1 \xe2\x89\xa4 N \xe2\x89\xa4 10\nAll values are \xe2\x89\xa4 50\nTL = 1s\n\n\nSubtask #2 (25 points):\n\n1 \xe2\x89\xa4 T \xe2\x89\xa4 50\n1 \xe2\x89\xa4 N \xe2\x89\xa4 300\nTL = 2s\n\n\nSubtask #3 (25 points):\n\nThe sum of all Ns is \xe2\x89\xa4 300,000\nAll values are \xe2\x89\xa4 150\nTL = 3.5s\n\n\nSubtask #4 (40 points):\n\nThe sum of all Ns is \xe2\x89\xa4 300,000\nOriginal constraints for N and valuex.\nTL = 4.5s\n\n\n\n                        Sample Input 1\n                        \n\n\n\n\n\n4\n10\n525 1210 15 6 40 22 441 35 220 121\n2 1\n1 3\n7 3\n2 5\n2 4\n5 8\n6 5\n9 5\n9 10\n3\n2 3 5\n1 2\n2 3\n5\n2 4 2 2 8\n1 2\n1 3\n3 4\n5 4\n2\n125 3\n1 2\n\n\n\n                        Sample Output 1\n                        \n\n\n\n\n\n3\n-1\n4\n1\n\n\nExplanation\nFirst test\n\n\nThere is only one path that generates a cubic number: 2 ? 5 ? 9; 1210 \xc3\x97 40 \xc3\x97 220 = 10648000 = 2203\nThere are 3 nodes in this path so the answer is 3.\n\nSecond test\nThere is no path that generates a cubic number so the answer is -1.\n\nThird test\nThere are two paths that generate a cubic number: 1 ? 2 and 1 ? 3 ? 4 ? 5.\nThe second one is longer so the answer is 4.\n\nFourth test\nThere is only one path that generates a cubic number and it contains only one node.\n\n\n\n\nAuthor:\n4\xe2\x98\x85alexvaleanu\n\n\nTester:\n6\xe2\x98\x85kingofnumbers\n\n\nEditorial:\nhttps://discuss.codechef.com/problems/MATCUT\n\n\nTags:\n\n               \n                 Trees, Hashmaps, Centroid Decomposition, Prime Divisors\n                 \n                     \n                     Data Structures, Graphs, Advanced Algorithms, Advanced Graph Algos, Mathematics, Number Theory, Integer Factorisation, Divisors\n                 \n               \n             \n             \n\n\n\n                        Difficulty Rating:\n                    \n\n3276\n\n\nDate Added:\n23-08-2017\n\n\nTime Limit:\n1 - 4.5 secs\n\n\nSource Limit:\n50000 Bytes\n\n\nLanguages:\nPYTH 3.6, JAVA, C, CPP14, PYTH, PYP3, CS2, ADA, PYPY, TEXT, PAS fpc, NODEJS, RUBY, PHP, GO, HASK, TCL, kotlin, PERL, SCALA, LUA, BASH, JS, rust, LISP sbcl, PAS gpc, BF, CLOJ, D, CAML, swift, FORT, ASM, FS, WSPC, LISP clisp, SCM guile, PERL6, ERL, CLPS, PRLG, ICK, NICE, ICON, SCM chicken, PIKE, SCM qobi, ST, NEM\n\n\n\n\n\nSubmit\n\n"