b"\nRead problems statements in mandarin chinese, russian and vietnamese as well.\n\n\tThere are N cities in Chefland. Chef owns the biggest traffic company in Chefland, and Chef has built N-1 bidirectional roads between these cities. The i-th road connects city ai and city bi, and is ci kms long. It's possible to travel between any two cities by going through these roads. However, only those people who have Chef's VIP card can use these roads. It costs 1 Chefcoin/km to travel on one of Chef\xe2\x80\x99s roads.\n\n\tA businessman named Fehc came to Chefland to compete with Chef's company and created his own traffic network. It also contains N-1 roads. The i-th of these roads connects city pi and city qi, and has length ri kms. Again, it is possible to travel between any two cities by going through Fehc's roads (and ignoring Chef's). Similar to Chef, only those people who have Fehc's VIP card can travel on these roads and it costs 1 Chefcoin/km to travel on one of Fehc's roads.\n\n\tOn New Year's Day in Chefland, there is expected to be a huge traffic flow because of people travelling to celebrate with family and friends. For any 1 \xe2\x89\xa4 i < j \xe2\x89\xa4 N, there will be exactly one person who wants to go from city i to city j. To achieve this, he should ask Chef or Fehc for VIP cards and travel along the roads permitted by the cards. However, Chef and Fehc are in a competing relationship, and hence any one person can only get one VIP card. A person will choose that company that has a shorter(cheaper) route from city i to city j, buy that company's VIP card, and travel along that company's roads. If there is a tie, he chooses an arbitrary company(this doesn't affect the answer of the problem).\n\n\tThere are M=N*(N-1)/2 people who will travel on New Year's Day. Your task is to compute the total amount of Chefcoins spent by them.\n\n\tInput\n\nThe first line of input contains a single integer T denoting the number of test cases.\nFor each test case, the first line contains a single integer N denoting the number of cities in Chefland.\nThe next N-1 lines each contain three space-separated integers ai, bi and ci, denoting a road by Chef's company.\nThe next N-1 lines each contain three space-separated integers pi, qi and ri, denoting a road by Fehc's company.\n\n\n\tOutput\n\n\tFor each test case, output one number denoting the total amount of Chefcoins that will be spent by the M travellers.\n\n\tConstraints\n\n1 \xe2\x89\xa4 T \xe2\x89\xa4 1000\n2 \xe2\x89\xa4 N \xe2\x89\xa4 50000\nthe sum of N over all test cases \xe2\x89\xa4 200000\n1 \xe2\x89\xa4 ai, bi, pi, qi \xe2\x89\xa4 N\n1 \xe2\x89\xa4 ci, ri \xe2\x89\xa4 4096\n\n\n\tSubtask #1 (8 points):\n\nN \xe2\x89\xa4 1000\nthe sum of N over all test cases \xe2\x89\xa4 5000\n\n\n\tSubtask #2 (10 points):\n\nFor any 1 \xe2\x89\xa4 i < N, ai = pi, bi = qi, ci = ri. In other words, Chef's and Fehc's traffic networks are exactly the same.\n\n\n\tSubtask #3 (23 points):\n\nFehc's traffic network is a chain 1-2-3-...-N\n\n\n\tSubtask #4 (59 points):\n\noriginal constraints\n\n\n                        Sample Input 1\n                        \n\n\n\n\n\n2\n3\n1 2 3\n2 3 2\n1 3 2\n2 3 3\n6\n4 3 2\n4 5 2\n2 4 2\n4 6 2\n1 5 1\n6 3 2\n1 5 1\n2 4 1\n6 5 1\n4 6 2\n\n\n\n                        Sample Output 1\n                        \n\n\n\n\n\n7\n39\n\n\nExplanation\n\nExample case 1: There are 3 people:\n\nThe first person goes from city 1 to city 2. He chooses Chef's roads and pays 3 chefcoin.\nThe second person goes from city 1 to city 3. He chooses Fehc's roads and pays 2 chefcoin.\nThe third person goes from city 2 to city 3. He chooses Chef's roads and pays 2 chefcoin.\n\n\n\n\n\nAuthor:\n7\xe2\x98\x85r_64\n\n\nEditorial:\nhttps://discuss.codechef.com/problems/CHEFTRAF\n\n\nTags:\n\n               \n                 centroid-decomposition, dfs-order, fenwick-tree, hard, lowest-common-ancestor, ltime52, r_64\n                 \n               \n             \n             \n\n\n\n                        Difficulty Rating:\n                    \n\n2705\n\n\nDate Added:\n22-09-2017\n\n\nTime Limit:\n9 secs\n\n\nSource Limit:\n50000 Bytes\n\n\nLanguages:\nPYTH 3.6, JAVA, C, CPP14, PYTH, PYP3, CS2, ADA, PYPY, TEXT, PAS fpc, NODEJS, RUBY, PHP, GO, HASK, TCL, kotlin, PERL, SCALA, LUA, BASH, JS, rust, LISP sbcl, PAS gpc, BF, CLOJ, D, CAML, swift, FORT, ASM, FS, WSPC, LISP clisp, SCM guile, PERL6, ERL, CLPS, PRLG, ICK, NICE, ICON, COB, SCM chicken, PIKE, SCM qobi, ST, NEM\n\n\n\n\n\nSubmit\n\n"