b"\nRead problem statements in Hindi, Bengali, Mandarin Chinese, Russian, and Vietnamese as well.\nChef has a tree with NN vertices (numbered 11 through N). The tree is rooted at the vertex 1. For each valid i, the weight of the i-th vertex is wi.\nFor a vertex u with depth d (the root has depth 1), let's denote the sequence of vertices on the path from u to the root by (v1,v2,\xe2\x80\xa6,vd), where v1=u and vd=1. Then, let Fu be the vector (i.e. sequence) (wv1,wv2,\xe2\x80\xa6,wvd), where the i-th element is Fu,i=wvi for each valid i.\nFor any two vertices u and v with the same depth d, let's define the dot product Fu\xe2\x8b\x85Fv=\xe2\x88\x91di=1Fu,i\xe2\x8b\x85Fv,i.\nYour task is to answer Q queries. In each query, you are given two vertices u and v with the same depth, and you should find Fu\xe2\x8b\x85Fv. Since the dot product can be large, compute it modulo 232.\nInput\n\nThe first line of the input contains two space-separated integers N and Q.\nThe second line contains N space-separated integers w1,w2,\xe2\x80\xa6,wN.\nEach of the next N\xe2\x88\x921 lines contains two space-separated integers u and v denoting that vertices u and v are connected by an edge.\nQ lines follow. Each of these lines contains two space-separated integers u and v describing a query.\n\nOutput\nFor each query, print a single line containing one integer Fu\xe2\x8b\x85Fv modulo 232.\nConstraints\n\n1\xe2\x89\xa4N,Q\xe2\x89\xa43\xe2\x8b\x85105\n1\xe2\x89\xa4wi\xe2\x89\xa4109 for each valid i\n1\xe2\x89\xa4u,v\xe2\x89\xa4N\nin each query, u and v have the same depth\n\nSubtasks\nSubtask #1 (15 points, time limit 1 second): N,Q\xe2\x89\xa41,000\nSubtask #2 (45 points, time limit 2 seconds): N,Q\xe2\x89\xa4105\nSubtask #3 (40 points, time limit 3.5 seconds): original constraints\n\n                        Sample Input 1\n                        \n\n\n\n\n\n5 2\n5 4 3 2 1\n1 2\n1 3\n2 4\n2 5\n2 3\n4 5\n\n\n\n                        Sample Output 1\n                        \n\n\n\n\n\n37\n43\n\n\nExplanation\n\nIn the first query, F2=(4,5) and F3=(3,5), so the scalar product is 4\xe2\x8b\x853+5\xe2\x8b\x855=37.\nIn the second query, F4=(2,4,5) and F5=(1,4,5), so the scalar product is 2\xe2\x8b\x851+4\xe2\x8b\x854+5\xe2\x8b\x855=43.\n\n\n\nAuthor:\n4\xe2\x98\x85kobor\n\n\nEditorial:\nhttps://discuss.codechef.com/problems/SCALSUM\n\n\nTags:\n\n               \n                 Trees, Pre processing, Square Root Decomposition, DFS, Queries\n                 \n                     \n                     Data Structures, Graphs, Advanced Algorithms, Algorithms, Graph Algos, Traversals\n                 \n               \n             \n             \n\n\n\n                        Difficulty Rating:\n                    \n\n2527\n\n\nDate Added:\n17-10-2020\n\n\nTime Limit:\n1 - 3.5 secs\n\n\nSource Limit:\n50000 Bytes\n\n\nLanguages:\nCPP17, PYTH 3.6, JAVA, C, CPP14, PYTH, PYP3, CS2, ADA, PYPY, TEXT, PAS fpc, NODEJS, RUBY, PHP, GO, HASK, TCL, kotlin, PERL, SCALA, LUA, BASH, JS, rust, LISP sbcl, PAS gpc, BF, CLOJ, R, D, CAML, swift, FORT, ASM, FS, WSPC, LISP clisp, SQL, SCM guile, PERL6, ERL, CLPS, PRLG, SQLQ, ICK, NICE, ICON, COB, SCM chicken, PIKE, SCM qobi, ST, NEM\n\n\n\n\n\nSubmit\n\n"