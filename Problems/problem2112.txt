b"\nRead problems statements in Mandarin chinese, Russian and Vietnamese as well.\n\xef\xbb\xbf\xef\xbb\xbfChef loves single-colored squares, so he got a rectangular board with size N\xc3\x97MN\xc3\x97M consisting only of black cells and white cells. He calculates the cost of the board in the following manner:\n\nLet's denote the number of ways to choose k2k2 white cells which form a square with edge length kk (and edges parallel to the borders of the board) by WkWk. For example, a 2\xc3\x9732\xc3\x973 board consisting of 6 white cells and no black cells has W1=6W1=6, W2=2W2=2 and W3=0W3=0. \nSimilarly, let's denote the number of ways to choose k2k2 black cells forming a square by BkBk.\nChef chose two sequences of non-negative integers CWCW and CBCB, each with length min(N,M)min(N,M). The cost of the board is defined as\n\xe2\x88\x91i=1min(N,M)CB,i\xe2\x8b\x85Bi+CW,i\xe2\x8b\x85Wi.\xe2\x88\x91i=1min(N,M)CB,i\xe2\x8b\x85Bi+CW,i\xe2\x8b\x85Wi.\n\nHowever, Chef accidentally spilled some sauce on the board while cooking, so the colors of some cells cannot be determined. Now he wants to repaint each of these cells using black or white paint. What is the maximum achievable cost of the resulting board? Note that he may paint different cells using different colors.\nInput\n\nThe first line of the input contains a single integer TT denoting the number of test cases. The description of TT test cases follows.\nThe first line of each test case contains two space-separated integers NN and MM.\nNN lines follow. For each ii (1\xe2\x89\xa4i\xe2\x89\xa4N1\xe2\x89\xa4i\xe2\x89\xa4N), the ii-th of these lines contains a string with length MM describing the ii-th row of the board \xe2\x80\x94 the character '0' stands for a white cell, '1' stands for a black cell and '?' stands for a cell with unknown color.\nThe following line contains K=min(N,M)K=min(N,M) space-separated integers CW,1,CW,2,\xe2\x80\xa6,CW,KCW,1,CW,2,\xe2\x80\xa6,CW,K.\nThe last line contains K=min(N,M)K=min(N,M) space-separated integers CB,1,CB,2,\xe2\x80\xa6,CB,KCB,1,CB,2,\xe2\x80\xa6,CB,K.\n\nOutput\nFor each test case, print a single line containing one integer \xe2\x80\x94 the maximum possible cost.\nConstraints\n\n1\xe2\x89\xa4T\xe2\x89\xa451\xe2\x89\xa4T\xe2\x89\xa45\n1\xe2\x89\xa4N\xe2\x8b\x85M\xe2\x89\xa45001\xe2\x89\xa4N\xe2\x8b\x85M\xe2\x89\xa4500\neach string contains only characters '0', '1' and '?'\n0\xe2\x89\xa4CW,i\xe2\x89\xa41080\xe2\x89\xa4CW,i\xe2\x89\xa4108 for each valid ii\n0\xe2\x89\xa4CB,i\xe2\x89\xa41080\xe2\x89\xa4CB,i\xe2\x89\xa4108 for each valid ii\n\nSubtasks\nSubtask #1 (5 points): 1\xe2\x89\xa4N\xe2\x8b\x85M\xe2\x89\xa4101\xe2\x89\xa4N\xe2\x8b\x85M\xe2\x89\xa410\nSubtask #2 (15 points): 1\xe2\x89\xa4N\xe2\x8b\x85M\xe2\x89\xa4401\xe2\x89\xa4N\xe2\x8b\x85M\xe2\x89\xa440\nSubtask #3 (80 points): original constraints\n\n                        Sample Input 1\n                        \n\n\n\n\n\n1\n3 3\n10?\n01?\n???\n1 1 1\n2 2 2\n\n\n\n                        Sample Output 1\n                        \n\n\n\n\n\n18\n\n\nExplanation\nExample case 1: Replacing each '?' by '1' gives the optimal answer.\n\n\n\nAuthor:\nratingoverflow\n\n\nTester:\n6\xe2\x98\x85mgch\n\n\nTags:\n\n               \n                 hard, june18, likecs, minimum-cut, ratingoverflow\n                 \n               \n             \n             \n\n\n\n                        Difficulty Rating:\n                    \n\n2742\n\n\nDate Added:\n20-05-2018\n\n\nTime Limit:\n3 secs\n\n\nSource Limit:\n50000 Bytes\n\n\nLanguages:\nPYTH 3.6, JAVA, C, CPP14, PYTH, PYP3, CS2, ADA, PYPY, TEXT, PAS fpc, NODEJS, RUBY, PHP, GO, HASK, TCL, kotlin, PERL, SCALA, LUA, BASH, JS, rust, LISP sbcl, PAS gpc, BF, CLOJ, D, CAML, swift, FORT, ASM, FS, WSPC, LISP clisp, SCM guile, PERL6, ERL, CLPS, PRLG, ICK, NICE, ICON, COB, SCM chicken, PIKE, SCM qobi, ST, NEM\n\n\n\n\n\nSubmit\n\n"