b"\n Read problems statements in Mandarin Chinese, Russian and Vietnamese as well.\nChef had a tree T with weighted nodes.\nOne day he decided that he wants to have two trees instead of one. So, he removed one of the edges of T.\nThe next day, he decided to have three trees instead of two. So, he removed one more edge from some of the trees he had.\nAnd so on. Every day, Chef was removing one, not yet removed edge, util he once got a forest, consisting of N single-node trees.\nChef thinks that the main characteristic of a tree is its' diameter. So he asks you to calculate the product of the diameters in obtained set of trees.\nSince the overall product might be quite large, output it modulo 109+7.\nNote\nIn this problem, we consider the diameter of the tree as the maximum sum of weights of the nodes over all simple paths in this tree.\nInput\nThe first line of the input contains an integer N denoting the number of nodes in the tree T.\nThe following line contains N space-separated integers Wi, denoting the weights of the nodes.\nEach of the following (N-1) lines contain two space-separated integers Xi Yi.\nEach of the following (N-1) lines contain a single integer Kj, denoting the number of the edge that will be deleted on the jth day.\nOutput\nOutput N lines.\nOn the ith line, output the product of the diameters of all the trees after (i-1) days modulo 109+7. Formally, if i > 1, output the product of the diameters of the obtained trees after deleting the edges K1, K2, ..., Ki - 1, modulo 109+7, otherwise output the diameter of the initial tree.\nConstraints\n\n1 \xe2\x89\xa4 N \xe2\x89\xa4 105\n1 \xe2\x89\xa4 Wi \xe2\x89\xa4 104\n1 \xe2\x89\xa4 Xi, Yi \xe2\x89\xa4 N\nK is a permutation of the integers from the range [1; N-1].\n\nSubtasks\n\nSubtask #1 (16 points): 1 \xe2\x89\xa4 N \xe2\x89\xa4 100\nSubtask #2 (24 points): 1 \xe2\x89\xa4 N \xe2\x89\xa4 5000\nSubtask #3 (60 points): no additional constraints\n\nExample\nInput:\n3\n1 2 3\n1 2\n1 3\n2\n1\n\nOutput:\n6\n9\n6\n\nExplanation\nThe diameter of the initial tree is 6 (node 2 to node 1 to node 3).\nAfter the first day (the deletion of the 2nd edge, i.e. 1 3), we get two trees, both with diameters 3.\nAfter the second day (the deletion of the 1st edge, i.e. 1 2), we get three trees with diameters 1, 2, 3, and their product equals to 6.\n\n\n\nAuthor:\nsergey_adm\n\n\nTester:\n4\xe2\x98\x85harshil7924\n\n\nEditorial:\nhttps://discuss.codechef.com/problems/TREEDIAM\n\n\nTags:\n\n               \n                 Trees, Disjoint Set Union, Lowest Common Ancestor, DFS, Diameter\n                 \n                     \n                     Data Structures, Graphs, Advanced Data Structures, Algorithms, Graph Algos, Traversals, Graph Measurements\n                 \n               \n             \n             \n\n\n\n                        Difficulty Rating:\n                    \n\n2970\n\n\nDate Added:\n6-08-2016\n\n\nTime Limit:\n1 secs\n\n\nSource Limit:\n50000 Bytes\n\n\nLanguages:\nPYTH 3.6, JAVA, C, CPP14, PYTH, PYP3, CS2, ADA, PYPY, TEXT, PAS fpc, NODEJS, RUBY, PHP, GO, HASK, TCL, PERL, SCALA, LUA, BASH, JS, LISP sbcl, PAS gpc, BF, CLOJ, D, CAML, FORT, ASM, FS, WSPC, LISP clisp, SCM guile, PERL6, ERL, CLPS, PRLG, ICK, NICE, ICON, SCM chicken, PIKE, SCM qobi, ST, NEM\n\n\n\n\n\nSubmit\n\n"