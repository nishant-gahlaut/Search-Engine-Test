b"\nRead problem statements in Hindi, Bengali, Mandarin Chinese, Russian, and Vietnamese as well.\nYou are given a rooted tree with NN vertices (numbered 1 through N) and a prime number P. Vertex 1 is the root of the tree and for each v (2\xe2\x89\xa4v\xe2\x89\xa4N), the parent of vertex v is pv (pv<v).\nA vertex s is an ancestor of another vertex f if s lies on the path between 1 and f (in particular, f is its own ancestor). For two vertices u and v, let's define LCA(u,v) as the vertex s with the largest number which is an ancestor of both u and v. Similarly, for two vertices v and s, let Lv,s be the set of all vertices u such that s=LCA(u,v).\nLet's define a set AP containing all sequences (indexed from 1) with length N whose elements are integers between 0 and P\xe2\x88\x921 inclusive. For two sequences a,b\xe2\x88\x88AP, let's define an operation LCA-convolution as a sequence c=a\xe2\x88\x97b such that for each valid x, cx=(N\xe2\x88\x91i=1\xe2\x88\x91j\xe2\x88\x88Li,xaibj)modP.\nYou are also given some sequence c\xe2\x88\x88AP. You have two tasks:\n\nFind the number of sequences a\xe2\x88\x88AP such that c=a\xe2\x88\x97a. Since this number can be large, compute it modulo 998,244,353.\nFind a sequence a\xe2\x88\x88AP such that c=a\xe2\x88\x97a (if it exists).\n\nInput\n\nThe first line of the input contains a single integer T denoting the number of test cases. The description of T test cases follows.\nThe first line of each test case contains two space-separated integers N and P.\nThe second line contains N\xe2\x88\x921 space-separated integers p2,p3,\xe2\x80\xa6,pN.\nThe third line contains N space-separated integers c1,c2,\xe2\x80\xa6,cN.\n\nOutput\nFor each test case, print two lines:\n\nThe first of these lines should contain a single integer \xe2\x80\x95 the number of sequences from the first task modulo 998,244,353.\nIf there is no sequence a\xe2\x88\x88AP such that c=a\xe2\x88\x97a, the second line should contain the integer \xe2\x88\x921.\nOtherwise, the second line should contain N space-separated integers a1,a2,\xe2\x80\xa6,aN, where a\xe2\x88\x88AP and c=a\xe2\x88\x97a should hold. If there is more than one such sequence, you may find any one of them.\n\nConstraints\n\n1\xe2\x89\xa4T\xe2\x89\xa4105\n2\xe2\x89\xa4N\xe2\x89\xa45\xe2\x8b\x85105\n3\xe2\x89\xa4P\xe2\x89\xa4109+9\nP is a prime\n1\xe2\x89\xa4pi<i for each valid i\n0\xe2\x89\xa4ci<P for each valid i\nthe sum of N over all test cases does not exceed 5\xe2\x8b\x85105\n\nSubtasks\nSubtask 1 (10 points, 1 second time limit):\n\nT\xe2\x89\xa4100\nN\xe2\x89\xa46\nP=3\n\nSubtask 2 (30 points, 1 second time limit):\n\nT\xe2\x89\xa4100\nthe sum of N over all test cases does not exceed 1,000\n\nSubtask 3 (60 points, 5 seconds time limit): original constraints\nExample Input\n3\n6 3\n1 1 2 3 2\n1 2 0 1 1 1\n5 3\n1 1 1 3\n2 1 0 2 1\n9 101\n1 1 2 3 2 4 3 5\n18 77 44 82 4 20 19 43 97\n\nExample Output\n32\n2 2 0 1 2 2\n0\n-1\n64\n3 70 5 76 20 11 25 12 81\n\n\n\n\nAuthor:\n7\xe2\x98\x85isaf27\n\n\nEditorial:\nhttps://discuss.codechef.com/problems/LCASQRT\n\n\nTags:\n\n               \n                 Trees, Number Theory, Quadratic Residue, DFS, Tonelli-Shanks algorithm\n                 \n                     \n                     Data Structures, Graphs, Mathematics, Modular Arithmetic, Algorithms, Graph Algos, Traversals\n                 \n               \n             \n             \n\n\n\n                        Difficulty Rating:\n                    \n\n2701\n\n\nDate Added:\n29-11-2020\n\n\nTime Limit:\n1 - 5 secs\n\n\nSource Limit:\n50000 Bytes\n\n\nLanguages:\nCPP17, PYTH 3.6, JAVA, C, CPP14, PYTH, PYP3, CS2, ADA, PYPY, TEXT, PAS fpc, NODEJS, RUBY, PHP, GO, HASK, TCL, kotlin, PERL, SCALA, LUA, BASH, JS, rust, LISP sbcl, PAS gpc, BF, CLOJ, R, D, CAML, swift, FORT, ASM, FS, WSPC, LISP clisp, SQL, SCM guile, PERL6, ERL, CLPS, PRLG, SQLQ, ICK, NICE, ICON, COB, SCM chicken, PIKE, SCM qobi, ST, NEM\n\n\n\n\n\nSubmit\n\n"