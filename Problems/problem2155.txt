b"\nRead problems statements in Mandarin chinese, Russian and Vietnamese as well.\nIn Chef's world, a single day lasts K hours. There is only one restaurant near Chef's home, and he always eats there. Chef always has his breakfast in the first hour of the day, and it takes him exactly 1 hour to have it. He always has L different dishes for breakfast. Through the rest of the day, Chef has some other smaller meals. Each small meal consists of only a single dish and he finishes eating it in exactly one hour. Each of the remaining hours, he does some activities. There are A different activities that Chef can do (play games, watch TV,... or even sleep). And each of those activities takes exactly one hour.\nChef never eats twice in a row in a day, but he can do the same activity consecutively. Note that, he might eat on the last hour of a day, and then eat in the first hour of the next day, because they are on different days.\nAssume that on the first day, the restaurant has D different dishes for Chef to choose from. Each of the next days, a new dish is added to their menu. The Chef wants to plan his schedule for each of the T days, starting from the first day. That is, he wants to decide what dishes he's going to have for breakfast, when and what he'll have for his small meals, and what activities he'll do. Help him calculate sum of the number of different plans he can make for each day. That is, you need to find (the number of different plans possible for day 1) +  (the number of different plans possible for day 2) + ... + (the number of different plans possible for day T). Of course, the answer maybe large, so print only the remainder modulo P.\nInput\n\nThe first line contains four space-separated integers K, A, P, Q, where Q denotes the number of queries.\nThen Q lines follow, each line containing three space-separated integers: L, D, T.\n\nOutput\nEach query, output the answer on a new line.\nConstraints\n\n2 \xe2\x89\xa4 K \xe2\x89\xa4 105\n1 \xe2\x89\xa4 A \xe2\x89\xa4 109\n108 + 7 \xe2\x89\xa4 P \xe2\x89\xa4 109 + 7, P is a prime.\n1 \xe2\x89\xa4 Q \xe2\x89\xa4 500\n1 \xe2\x89\xa4 L \xe2\x89\xa4 D \xe2\x89\xa4 D + T - 1 \xe2\x89\xa4 107\n\nSubtasks:\n\nSubtask #1 (5 points): L \xe2\x89\xa4 D \xe2\x89\xa4 D + T - 1 \xe2\x89\xa4 105\nSubtask #2 (10 points): K = 2\nSubtask #3 (25 points): K \xe2\x89\xa4 1000\nSubtask #4 (60 points): Original constrains\n\n\n                        Sample Input 1\n                        \n\n\n\n\n\n3 2 1000000007 1\n1 1 2\n\n\n\n                        Sample Output 1\n                        \n\n\n\n\n\n22\n\n\n\n\n\nAuthor:\n6\xe2\x98\x85chemthan\n\n\nTags:\n\n               \n                 chemthan, combinatorics, fast-fourier-transform, hard, nov17\n                 \n               \n             \n             \n\n\n\n                        Difficulty Rating:\n                    \n\n3260\n\n\nDate Added:\n23-08-2017\n\n\nTime Limit:\n6 secs\n\n\nSource Limit:\n50000 Bytes\n\n\nLanguages:\nPYTH 3.6, JAVA, C, CPP14, PYTH, PYP3, CS2, ADA, PYPY, TEXT, PAS fpc, NODEJS, RUBY, PHP, GO, HASK, TCL, kotlin, PERL, SCALA, LUA, BASH, JS, rust, LISP sbcl, PAS gpc, BF, CLOJ, D, CAML, swift, FORT, ASM, FS, WSPC, LISP clisp, SCM guile, PERL6, ERL, CLPS, PRLG, ICK, NICE, ICON, SCM chicken, PIKE, SCM qobi, ST, NEM\n\n\n\n\n\nSubmit\n\n"