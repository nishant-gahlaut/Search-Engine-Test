b'\n Read problems statements in Mandarin Chinese  and Russian.\n Leonid is developing new programming language. The key feature of his language is fast multiplication and raising to a power operations. He is asking you to help with the following task. \nYou have an expression S and positive integer M. S has the following structure: A1*A2*...*An where "*" is multiplication operation. Each Ai is an expression Xi**Yi  where Xi and Yi are non-negative integers and "**" is raising Xi to power Yi operation. \n.\nYour task is just to find the value of an expression S modulo M \nInput\nThe first line of the input contains an integer T denoting the number of test cases. Each of the following T testcases is described by one line which contains  one positive integer M and expression S separated by whitespace.\nOutput\nFor each test case, output a single line containing one integer corresponding to value of S modulo M \nConstraints\n\n1 \xe2\x89\xa4 T \xe2\x89\xa4 20\n 1 \xe2\x89\xa4 M \xe2\x89\xa4 1018\n 1 \xe2\x89\xa4 length of S \xe2\x89\xa4 104\n 0 \xe2\x89\xa4 Xi, Yi \xe2\x89\xa4 109997 \nIt\'s guaranteed that there will not be 0**0 expression\n\n Subtasks \nSubtask #1[30 points]: Xi, Yi < 10, M < 10 4\nSubtask #2[40 points]:  M < 109\nSubtask #3[30 points]: no additional conditions\nExample\nInput:\n2\n1000 2**3*3**1\n100000 11**2*2**4\nOutput:\n24\n1936\n\n\n\n\nAuthor:\n4\xe2\x98\x85pavel1996\n\n\nTester:\n5\xe2\x98\x85rubanenko\n\n\nTags:\n\n               \n                 Exponentiation, Big Integer\n                 \n                     \n                     Mathematics, Number Theory, Arbitrary Precision\n                 \n               \n             \n             \n\n\n\n                        Difficulty Rating:\n                    \n\n2270\n\n\nDate Added:\n25-12-2014\n\n\nTime Limit:\n2 - 3 secs\n\n\nSource Limit:\n50000 Bytes\n\n\nLanguages:\nPYTH 3.6, JAVA, C, CPP14, PYTH, PYP3, CS2, ADA, TEXT, PAS fpc, NODEJS, RUBY, PHP, GO, HASK, TCL, PERL, SCALA, LUA, BASH, JS, LISP sbcl, PAS gpc, BF, CLOJ, D, CAML, FORT, ASM, FS, WSPC, LISP clisp, SCM guile, PERL6, ERL, CLPS, PRLG, ICK, NICE, ICON, PIKE, SCM qobi, ST, NEM\n\n\n\n\n\nSubmit\n\n'